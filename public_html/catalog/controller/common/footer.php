<?php
class ControllerCommonFooter extends Controller {
	public function index() {
		$this->load->language('blog/menu');
		$this->load->language('common/footer');

		$this->load->model('catalog/information');

		// $data['informations'] = array();
		// foreach ($this->model_catalog_information->getInformations() as $result) {
		// 	if ($result['bottom']) {
		// 		$data['informations'][] = array(
		// 			'title' => $result['title'],
		// 			'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
		// 		);
		// 	}
		// }
		$data['informations'] = $this->load->controller('common/header/getNavigationLinks');
		$data['home'] = $this->url->link('common/home');
		$host = isset($this->request->server['HTTPS']) && (($this->request->server['HTTPS'] == 'on') || ($this->request->server['HTTPS'] == '1')) ? HTTPS_SERVER : HTTP_SERVER;
		if ($this->request->server['REQUEST_URI'] == '/') {
			$data['og_url'] = $this->url->link('common/home');
		} else {
			$data['og_url'] = $host . substr($this->request->server['REQUEST_URI'], 1, (strlen($this->request->server['REQUEST_URI'])-1));
		}

		$data['contact'] = $this->url->link('information/contact');
		$data['return'] = $this->url->link('account/return/add', '', true);
		$data['sitemap'] = $this->url->link('information/sitemap');
		$data['tracking'] = $this->url->link('information/tracking');
		$data['manufacturer'] = $this->url->link('product/manufacturer');
		$data['voucher'] = $this->url->link('account/voucher', '', true);
		$data['affiliate'] = $this->url->link('affiliate/login', '', true);
		$data['special'] = $this->url->link('product/special');
		$data['account'] = $this->url->link('account/account', '', true);
		$data['order'] = $this->url->link('account/order', '', true);
		$data['wishlist'] = $this->url->link('account/wishlist', '', true);
		$data['newsletter'] = $this->url->link('account/newsletter', '', true);

		$data['email'] = $this->config->get('config_email');
		$data['telephone'] = $this->config->get('config_telephone');
		$data['open'] = nl2br($this->config->get('config_open'));
		$data['formated_telephone'] = formatPhoneNumber($this->config->get('config_telephone'));
		$data['powered'] = sprintf($this->language->get('text_powered'), $this->config->get('config_name'), date('Y', time()));

		// Whos Online
		if ($this->config->get('config_customer_online')) {
			$this->load->model('tool/online');

			if (isset($this->request->server['REMOTE_ADDR'])) {
				$ip = $this->request->server['REMOTE_ADDR'];
			} else {
				$ip = '';
			}

			if (isset($this->request->server['HTTP_HOST']) && isset($this->request->server['REQUEST_URI'])) {
				$url = ($this->request->server['HTTPS'] ? 'https://' : 'http://') . $this->request->server['HTTP_HOST'] . $this->request->server['REQUEST_URI'];
			} else {
				$url = '';
			}

			if (isset($this->request->server['HTTP_REFERER'])) {
				$referer = $this->request->server['HTTP_REFERER'];
			} else {
				$referer = '';
			}

			$this->model_tool_online->addOnline($ip, $this->customer->getId(), $url, $referer);
		}

		$data['social_links'] = [
			[
				'name' => strtolower('Dzen'),
				'href' => 'https://dzen.ru/berisey',
				'title' => 'ссылка на наш Дзен паблик',
				'icon' => '<svg class="w-10 h-10 transition hover:scale-110" viewBox="0 0 33 32" fill="lightBlack" xmlns="http://www.w3.org/2000/svg"><path d="M19.9621 31.9997H16.6699C16.6966 31.4527 16.7187 30.9053 16.7513 30.3587C16.8468 28.7533 16.9349 27.1474 17.0496 25.5432C17.1176 24.5898 17.2932 23.6507 17.5507 22.7295C18.0951 20.7819 19.144 19.191 20.8658 18.0837C22.3114 17.1545 23.9402 16.792 25.6132 16.5913C26.4656 16.4891 27.3238 16.4236 28.1808 16.3718C29.3235 16.303 30.4675 16.2609 31.6111 16.2129C31.8998 16.2008 32.1897 16.2112 32.4922 16.2112C32.4943 16.2417 32.5001 16.2821 32.5001 16.3222C32.4943 18.8973 32.5164 21.474 32.2477 24.0399C32.128 25.1865 31.929 26.3196 31.5397 27.4107C31.0633 28.7466 30.3064 29.8535 29.0227 30.5477C27.7539 31.2337 26.3788 31.5574 24.9657 31.6918C23.5026 31.8307 22.0307 31.8762 20.5625 31.963C20.3622 31.9746 20.162 31.9872 19.9621 31.9993V31.9997Z" fill="#313131"/><path d="M0.500275 15.832C0.500275 14.7205 0.500275 13.6095 0.500275 12.4984C0.510705 12.4025 0.526142 12.3069 0.530731 12.2105C0.591644 10.9493 0.62961 9.68635 0.716389 8.42676C0.797328 7.25604 1.00176 6.10368 1.33344 4.97343C1.92964 2.94073 3.18752 1.56265 5.22476 0.902188C6.71044 0.419881 8.24035 0.215443 9.78653 0.137422C11.3665 0.0577332 12.9502 0.0418788 14.5323 0.00683223C15.1206 -0.00610161 15.7092 0.00474613 16.3175 0.00474613C16.2958 0.575921 16.2821 1.12916 16.252 1.68114C16.1732 3.12806 16.0964 4.57498 16 6.02107C15.9304 7.06454 15.7635 8.09549 15.4977 9.1085C15.0897 10.6639 14.3604 12.0345 13.1626 13.1301C12.0557 14.1427 10.7361 14.7385 9.28963 15.0768C8.21574 15.3276 7.12598 15.474 6.02622 15.5429C4.82173 15.618 3.61683 15.681 2.41151 15.7448C1.77485 15.7782 1.13735 15.8028 0.500275 15.832Z" fill="#313131"/><path d="M0.500417 19.4991V16.1655C0.638096 16.1785 0.775776 16.1968 0.913872 16.2039C2.63903 16.289 4.36461 16.3629 6.08894 16.4605C7.16785 16.5218 8.23757 16.6712 9.29061 16.9207C12.4877 17.6788 14.5867 19.5947 15.4691 22.7902C15.7928 23.9621 15.9572 25.1612 16.0377 26.3703C16.1287 27.7334 16.1871 29.0985 16.2588 30.4628C16.286 30.9752 16.3102 31.4875 16.3356 31.9999H13.0434C12.975 31.9915 12.907 31.979 12.8386 31.9761C11.501 31.9131 10.1617 31.8768 8.82667 31.7817C7.5521 31.6907 6.29797 31.4675 5.08347 31.0449C3.3825 30.4528 2.18761 29.3493 1.55179 27.6499C1.15794 26.5973 0.902608 25.5096 0.807066 24.3965C0.680235 22.9253 0.623494 21.4484 0.53588 19.9739C0.526284 19.8154 0.512099 19.6572 0.5 19.4991H0.500417Z" fill="#313131"/><path d="M32.491 15.7762C32.0626 15.7762 31.6474 15.79 31.2336 15.7737C30.1242 15.729 29.0144 15.6886 27.9067 15.6151C26.3113 15.5092 24.7184 15.374 23.171 14.9276C20.2438 14.0831 18.3789 12.186 17.5491 9.26296C17.2896 8.34924 17.1173 7.41634 17.0493 6.47008C16.9349 4.87964 16.8457 3.28752 16.753 1.69582C16.7209 1.14217 16.7092 0.587268 16.6871 0.00232399C16.7635 0.00232399 16.8302 0.00148955 16.8966 0.00232399C18.7569 0.0302778 20.6185 0.030695 22.4776 0.0945298C24.1498 0.151689 25.8153 0.308147 27.4311 0.790871C28.1596 1.00824 28.8488 1.30948 29.4834 1.73379C30.5243 2.43013 31.1263 3.44189 31.5394 4.58758C31.9345 5.68404 32.1293 6.82514 32.2495 7.97917C32.5152 10.5321 32.4935 13.0947 32.4998 15.6564C32.4998 15.7036 32.4931 15.7507 32.491 15.7762Z" fill="#313131"/></svg>',
			],
			[
				'name' => strtolower('RuTube'),
				'href' => 'https://rutube.ru/channel/35223411/',
				'title' => 'ссылка на наш Rutube канал',
				'icon' => '<svg class="w-10 h-10 transition hover:scale-110" viewBox="0 0 33 32" fill="lightBlack" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.5 6.33859C0.5 5.67347 1.03726 5.13428 1.70001 5.13428H23.3587C24.7736 5.13428 25.9714 5.28305 26.9703 5.56678C26.9846 5.57082 26.9987 5.57513 27.0128 5.5797C28.0404 5.91321 28.9134 6.42208 29.6924 7.13864C29.7093 7.15414 29.7257 7.17013 29.7416 7.18657C30.4742 7.94219 31.0121 8.80629 31.3262 9.81082C31.6266 10.7718 31.7782 11.9565 31.7782 13.371V15.1291C31.7782 17.4703 31.3744 19.4796 30.3445 20.8479L30.3444 20.848C29.6488 21.7718 28.6916 22.4221 27.5414 22.8451L32.255 29.0619C32.5311 29.4261 32.5777 29.916 32.3752 30.326C32.1726 30.7361 31.756 30.9955 31.3 30.9955H24.5499C24.1564 30.9955 23.7879 30.8019 23.5637 30.4773L18.6512 23.3656H8.92825V29.7912C8.92825 30.4563 8.39099 30.9955 7.72824 30.9955H1.70001C1.03726 30.9955 0.5 30.4563 0.5 29.7912V6.33859ZM2.90001 7.5429V28.5869H6.52824V22.1613C6.52824 21.4961 7.0655 20.9569 7.72824 20.9569H19.2795C19.673 20.9569 20.0415 21.1506 20.2657 21.4751L25.1782 28.5869H28.879L24.5334 22.8554C24.2773 22.5176 24.2173 22.0695 24.3754 21.6759C24.5335 21.2822 24.8864 21.0012 25.3043 20.9361C26.9217 20.6841 27.8857 20.1181 28.4295 19.396C28.9875 18.6547 29.3782 17.2884 29.3782 15.1291V13.371C29.3782 12.1131 29.2414 11.1882 29.0362 10.5318C28.8477 9.92885 28.5267 9.39395 28.0454 8.89104C27.5367 8.42919 26.9795 8.10329 26.2953 7.87832C25.5641 7.67337 24.6025 7.5429 23.3587 7.5429H2.90001ZM6.52824 11.5073C6.52824 10.8422 7.0655 10.303 7.72824 10.303H22.3841C22.8604 10.303 23.3077 10.3427 23.7054 10.4349C24.0892 10.5239 24.511 10.681 24.8572 10.976C25.5244 11.5445 25.75 12.4197 25.75 13.2654V15.2345C25.75 16.1025 25.5307 16.9849 24.8572 17.5587C24.4906 17.8712 24.0459 18.0143 23.6711 18.0896C23.2892 18.1664 22.8624 18.1953 22.4173 18.1966C22.4063 18.1969 22.3952 18.1971 22.3841 18.1971H7.72824C7.0655 18.1971 6.52824 17.6579 6.52824 16.9928V11.5073ZM22.3528 15.7884C22.3632 15.7882 22.3737 15.788 22.3841 15.788C22.7573 15.788 23.0225 15.7636 23.1996 15.728C23.2385 15.7201 23.2692 15.7125 23.2927 15.706C23.3182 15.6304 23.3499 15.4823 23.3499 15.2345V13.2654C23.3499 13.0356 23.3183 12.8965 23.2933 12.8262C23.2922 12.8231 23.2911 12.8201 23.2901 12.8174C23.2631 12.8077 23.2225 12.795 23.1651 12.7817C22.9943 12.7421 22.7379 12.7116 22.3841 12.7116H8.92825V15.7884H22.3528ZM23.2733 12.7803C23.273 12.7798 23.2728 12.7795 23.2728 12.7795C23.2728 12.7795 23.273 12.7798 23.2733 12.7803ZM23.2709 15.7576C23.2709 15.7576 23.2711 15.7574 23.2714 15.7569C23.2711 15.7574 23.271 15.7576 23.2709 15.7576Z" fill="#313131"/><path d="M30.0843 6.04898C31.2018 6.04898 32.1084 5.14262 32.1084 4.02449C32.1084 2.90636 31.2018 2 30.0843 2C28.9659 2 28.0594 2.90636 28.0594 4.02449C28.0594 5.14262 28.9659 6.04898 30.0843 6.04898Z" fill="black"/></svg>',
			],
			[
				'name' => strtolower('YouTube'),
				'href' => 'https://rutube.ru/channel/35223411/',
				'title' => 'ссылка на наш YouTube канал',
				'icon' => '<svg class="w-10 h-10 transition hover:scale-110" viewBox="0 0 33 32" fill="lightBlack" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.7413 4.82793C7.95918 4.91836 4.928 5.17016 3.88235 5.48076C2.48182 5.89682 1.39603 7.09545 1.12187 8.52816C0.955926 9.39578 0.726106 11.1341 0.615016 12.363C0.460654 14.0701 0.461907 18.0194 0.617333 19.7836C0.840327 22.3146 1.11373 23.9872 1.40373 24.5949C1.91096 25.6575 2.78773 26.428 3.86431 26.7571C4.66918 27.0031 6.50518 27.1898 9.6122 27.3415C11.8393 27.4502 21.2068 27.4508 23.3889 27.3424C26.1119 27.207 27.8525 27.0514 28.7845 26.8599C30.0511 26.5997 31.209 25.6353 31.697 24.4344C31.9317 23.8567 32.2113 22.0051 32.4181 19.6584C32.5411 18.2626 32.5216 13.732 32.3863 12.2377C32.2244 10.4509 31.9189 8.39465 31.7478 7.93971C31.2695 6.66812 30.0956 5.64752 28.8056 5.38201C27.6361 5.14129 25.1586 4.95399 21.7607 4.84941C19.9969 4.79512 13.6798 4.78159 11.7413 4.82793ZM17.4285 13.6541C19.6562 14.9498 21.5144 16.043 21.5578 16.0836C21.6195 16.1411 20.826 16.628 17.9257 18.3124C15.8848 19.4978 14.0106 20.588 13.7609 20.7351L13.3069 21.0026V16.1505C13.3069 13.4818 13.3229 11.2984 13.3424 11.2984C13.362 11.2984 15.2007 12.3585 17.4285 13.6541Z" fill="#313131"/></svg>'],
		]; 


		$data['scripts'] = $this->document->getScripts('footer');
		$data['styles'] = $this->document->getStyles('footer');
		
		return $this->load->view('common/footer', $data);
	}
}
